locality client : 1
locality server 
name X<@i> : DH @ client<i>
name Z<@i> : DH @ client<i>
name Y : DH @ server

random_oracle L<i> : dh_combine(dhpk(get(X<@i>)), get(Y)) -> nonce

def server_main() @ server : Unit = 
    input h in 
    pcase (exists j:idx. h = dhpk(get(X<@j>))) in 
    choose_idx j | h = dhpk(get(X<@j>)) in
    corr_case Y in 
    corr_case X<@j> in 
    let y = hash<L, j>(dh_combine<name X<@j>, name Y>(h, get(Y))) in 
    ()


