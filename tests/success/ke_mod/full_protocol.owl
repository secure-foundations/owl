include "psk_ke.owl"
include "dh_ke.owl" 
include "transp.owl"

module Full(P : Params, K : functor (Q : Params) => KE(Q)) = { 
    module KE = K(P)
    module T = Transp(P, KE)
    def Server_main () @ P.Server 
        : Option (if sec(P.data) then Name(P.data) else Data<adv>) 
        = corr_case P.data in call T.server()

    def Client_main () @ P.Client
        : Unit
        = call T.client(get(P.data))

}

module FullDH (P : Params) = Full(P, DH_KE)

module FullPSK (P : Params) = Full(P, PSK_KE)

